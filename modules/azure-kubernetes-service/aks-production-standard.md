# AKS Production Standard

These contains the configuration options for AKS production Standard which have been adopted for this repo

|             |                                  |                                                                                                                                                                                                                              |
| ----------- | -------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|             | Type                             | Value                                                                                                                                                                                                                        |
|             | Availability Zones               | If the region supports AZ, we configure AZ on behalf of the customer.                                                                                                                                                        |
|             | AKS Pricing Tier                 | Standard                                                                                                                                                                                                                     |
|             | Kubernetes version               | (Null) Remind about version skew in different regions. Â Using Null in the Terraform default value, will use the latest GA version available across all regions.                                                              |
|             | Kubernetes Automatic upgrade     | Enabled with patch                                                                                                                                                                                                           |
|             | Node OS upgrade channel          | Node Image                                                                                                                                                                                                                   |
|             | Authentication and Authorization | [Microsoft Entra](https://learn.microsoft.com/en-us/azure/aks/concepts-identity#microsoft-entra-integration) with Kubernetes RBAC                                                                                            |
|             | CSI Secret Store Driver          | True (installs an additional pod)                                                                                                                                                                                            |
|             | Cluster Identity                 | User Assigned                                                                                                                                                                                                                |
|             | Enabled Virtual Nodes            | False                                                                                                                                                                                                                        |
|             | Node pool OS disk encryption     | Encryption at-rest with a platform-managed key                                                                                                                                                                               |
|             | Enable private cluster           | True, Default to VNet Integration~~false~~                                                                                                                                                                                   |
|             | Set authorized IP ranges         | false                                                                                                                                                                                                                        |
|             | Network configuration (Pending)  | Azure CNI Overlay  <br>  <br><br>The network configuration should also guide the customer in reasonable subnet sizes that leave enough room for cluster autoscaling and upgrades.                                            |
|             | Bring your own virtual network   | True: The network in a production environment should not follow the cluster lifecycle. The network should be in a user-controlled resource group where is possible to enforce Azure Policies or attach other Azure products. |
|             | Network Outbound type           | NAT Gateway : this is necessary because the Standard Load balancer has a limit in handing outbound connections.                                                                                                              |
|             | Network Policy                   | Calico (Open-source networking solution)                                                                                                                                                                                     |
|             | Azure Monitor                    | Default Configuration (have Log Analytics Workspace and Platform Metrics Alerts) Use Basic Logs                                                                                                                              |
|             | ~~Alerting~~                     | ~~True~~                                                                                                                                                                                                                     |
|             | Azure Policy                     | Enabled                                                                                                                                                                                                                      |
|             |                                  |                                                                                                                                                                                                                              |
| Node Pool   | Name                             | agentpool                                                                                                                                                                                                                    |
|             | Mode                             | System                                                                                                                                                                                                                       |
|             | Node Size                        | Standard_D4d_v5                                                                                                                                                                                                              |
|             | OS SKU                           | Ubuntu                                                                                                                                                                                                                       |
|             | Node Count                       | 2-5                                                                                                                                                                                                                          |
|             | Availability Zones               | If the region supports AZ, we configure AZ on behalf of the customer.                                                                                                                                                        |
|             | Max pods/node                    | 110, 64                                                                                                                                                                                                                      |
|             | Enable Azure Spot instances      | Disabled                                                                                                                                                                                                                     |
|             | Scale Method                     | Autoscale                                                                                                                                                                                                                    |
| Node Pool 2 | Name                             | userpool 1                                                                                                                                                                                                                   |
|             | Mode                             | User                                                                                                                                                                                                                         |
|             | Node Size                        | Standard_D4d_v5                                                                                                                                                                                                              |
|             | OS SKU                           | Ubuntu                                                                                                                                                                                                                       |
|             | Node Count                       | 2-100                                                                                                                                                                                                                        |
|             | Availability Zones               | 1                                                                                                                                                                                                                            |
|             | Max pods/node                    | 110                                                                                                                                                                                                                          |
| Node Pool 3 | Name                             | Userpool 2                                                                                                                                                                                                                   |
|             | Mode                             | User                                                                                                                                                                                                                         |
|             | Node Size                        | Standard_D4d_v5                                                                                                                                                                                                              |
|             | OS SKU                           | Ubuntu                                                                                                                                                                                                                       |
|             | Node Count                       | 2-100                                                                                                                                                                                                                        |
|             | Availability Zones               | 2                                                                                                                                                                                                                            |
|             | Max pods/node                    | 110                                                                                                                                                                                                                          |
| Node Pool 4 | Name                             | Userpool 3                                                                                                                                                                                                                   |
|             | Mode                             | User                                                                                                                                                                                                                         |
|             | Node Size                        | Standard_D4d_v5                                                                                                                                                                                                              |
|             | OS SKU                           | Ubuntu                                                                                                                                                                                                                       |
|             | Node Count                       | 2-100                                                                                                                                                                                                                        |
|             | Availability Zones               | 3                                                                                                                                                                                                                            |
|             | Max pods/node                    | 110                                                                                                                                                                                                                          |
